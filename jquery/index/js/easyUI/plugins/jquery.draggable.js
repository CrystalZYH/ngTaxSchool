(function(F){function B(H){var J=F.data(H.data.target,"draggable");var L=J.options;var M=J.proxy;var G=H.data;var I=G.startLeft+H.pageX-G.startX;var K=G.startTop+H.pageY-G.startY;if(M){if(M.parent()[0]==document.body){if(L.deltaX!=null&&L.deltaX!=undefined){I=H.pageX+L.deltaX}else{I=H.pageX-H.data.offsetWidth}if(L.deltaY!=null&&L.deltaY!=undefined){K=H.pageY+L.deltaY}else{K=H.pageY-H.data.offsetHeight}}else{if(L.deltaX!=null&&L.deltaX!=undefined){I+=H.data.offsetWidth+L.deltaX}if(L.deltaY!=null&&L.deltaY!=undefined){K+=H.data.offsetHeight+L.deltaY}}}if(H.data.parent!=document.body){I+=F(H.data.parent).scrollLeft();K+=F(H.data.parent).scrollTop()}if(L.axis=="h"){G.left=I}else{if(L.axis=="v"){G.top=K}else{G.left=I;G.top=K}}}function C(H){var I=F.data(H.data.target,"draggable");var G=I.options;var J=I.proxy;if(!J){J=F(H.data.target)}J.css({left:H.data.left,top:H.data.top});F("body").css("cursor",G.cursor)}function E(H){F.fn.draggable.isDragging=true;var J=F.data(H.data.target,"draggable");var K=J.options;var I=F(".droppable").filter(function(){return H.data.target!=this}).filter(function(){var L=F.data(this,"droppable").options.accept;if(L){return F(L).filter(function(){return this==H.data.target}).length>0}else{return true}});J.droppables=I;var G=J.proxy;if(!G){if(K.proxy){if(K.proxy=="clone"){G=F(H.data.target).clone().insertAfter(H.data.target)}else{G=K.proxy.call(H.data.target,H.data.target)}J.proxy=G}else{G=F(H.data.target)}}G.css("position","absolute");B(H);C(H);K.onStartDrag.call(H.data.target,H);return false}function D(G){var H=F.data(G.data.target,"draggable");B(G);if(H.options.onDrag.call(G.data.target,G)!=false){C(G)}var I=G.data.target;H.droppables.each(function(){var K=F(this);if(K.droppable("options").disabled){return}var J=K.offset();if(G.pageX>J.left&&G.pageX<J.left+K.outerWidth()&&G.pageY>J.top&&G.pageY<J.top+K.outerHeight()){if(!this.entered){F(this).trigger("_dragenter",[I]);this.entered=true}F(this).trigger("_dragover",[I])}else{if(this.entered){F(this).trigger("_dragleave",[I]);this.entered=false}}});return false}function A(I){F.fn.draggable.isDragging=false;D(I);var M=F.data(I.data.target,"draggable");var G=M.proxy;var N=M.options;if(N.revert){if(H()==true){F(I.data.target).css({position:I.data.startPosition,left:I.data.startLeft,top:I.data.startTop})}else{if(G){var K,L;if(G.parent()[0]==document.body){K=I.data.startX-I.data.offsetWidth;L=I.data.startY-I.data.offsetHeight}else{K=I.data.startLeft;L=I.data.startTop}G.animate({left:K,top:L},function(){J()})}else{F(I.data.target).animate({left:I.data.startLeft,top:I.data.startTop},function(){F(I.data.target).css("position",I.data.startPosition)})}}}else{F(I.data.target).css({position:"absolute",left:I.data.left,top:I.data.top});H()}N.onStopDrag.call(I.data.target,I);F(document).unbind(".draggable");setTimeout(function(){F("body").css("cursor","")},100);function J(){if(G){G.remove()}M.proxy=null}function H(){var O=false;M.droppables.each(function(){var P=F(this);if(P.droppable("options").disabled){return}var Q=P.offset();if(I.pageX>Q.left&&I.pageX<Q.left+P.outerWidth()&&I.pageY>Q.top&&I.pageY<Q.top+P.outerHeight()){if(N.revert){F(I.data.target).css({position:I.data.startPosition,left:I.data.startLeft,top:I.data.startTop})}F(this).trigger("_drop",[I.data.target]);J();O=true;this.entered=false;return false}});if(!O&&!N.revert){J()}return O}return false}F.fn.draggable=function(H,G){if(typeof H=="string"){return F.fn.draggable.methods[H](this,G)}return this.each(function(){var J;var L=F.data(this,"draggable");if(L){L.handle.unbind(".draggable");J=F.extend(L.options,H)}else{J=F.extend({},F.fn.draggable.defaults,F.fn.draggable.parseOptions(this),H||{})}var K=J.handle?(typeof J.handle=="string"?F(J.handle,this):J.handle):F(this);F.data(this,"draggable",{options:J,handle:K});if(J.disabled){F(this).css("cursor","");return}K.unbind(".draggable").bind("mousemove.draggable",{target:this},function(N){if(F.fn.draggable.isDragging){return}var M=F.data(N.data.target,"draggable").options;if(I(N)){F(this).css("cursor",M.cursor)}else{F(this).css("cursor","")}}).bind("mouseleave.draggable",{target:this},function(M){F(this).css("cursor","")}).bind("mousedown.draggable",{target:this},function(O){if(I(O)==false){return}F(this).css("cursor","");var P=F(O.data.target).position();var Q=F(O.data.target).offset();var M={startPosition:F(O.data.target).css("position"),startLeft:P.left,startTop:P.top,left:P.left,top:P.top,startX:O.pageX,startY:O.pageY,offsetWidth:(O.pageX-Q.left),offsetHeight:(O.pageY-Q.top),target:O.data.target,parent:F(O.data.target).parent()[0]};F.extend(O.data,M);var N=F.data(O.data.target,"draggable").options;if(N.onBeforeDrag.call(O.data.target,O)==false){return}F(document).bind("mousedown.draggable",O.data,E);F(document).bind("mousemove.draggable",O.data,D);F(document).bind("mouseup.draggable",O.data,A)});function I(M){var V=F.data(M.data.target,"draggable");var R=V.handle;var Q=F(R).offset();var O=F(R).outerWidth();var N=F(R).outerHeight();var P=M.pageY-Q.top;var S=Q.left+O-M.pageX;var U=Q.top+N-M.pageY;var T=M.pageX-Q.left;return Math.min(P,S,U,T)>V.options.edge}})};F.fn.draggable.methods={options:function(G){return F.data(G[0],"draggable").options},proxy:function(G){return F.data(G[0],"draggable").proxy},enable:function(G){return G.each(function(){F(this).draggable({disabled:false})})},disable:function(G){return G.each(function(){F(this).draggable({disabled:true})})}};F.fn.draggable.parseOptions=function(G){var H=F(G);return F.extend({},F.parser.parseOptions(G,["cursor","handle","axis",{"revert":"boolean","deltaX":"number","deltaY":"number","edge":"number"}]),{disabled:(H.attr("disabled")?true:undefined)})};F.fn.draggable.defaults={proxy:null,revert:false,cursor:"move",deltaX:null,deltaY:null,handle:null,disabled:false,edge:0,axis:null,onBeforeDrag:function(G){},onStartDrag:function(G){},onDrag:function(G){},onStopDrag:function(G){}};F.fn.draggable.isDragging=false})(jQuery);