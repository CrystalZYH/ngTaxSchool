(function(F){function B(I){F(I).addClass("numberbox-f");var J=F('<input type="hidden">').insertAfter(I);var K=F(I).attr("name");if(K){J.attr("name",K);F(I).removeAttr("name").attr("numberboxName",K)}return J}function G(I){var J=F.data(I,"numberbox").options;var K=J.onChange;J.onChange=function(){};E(I,J.parser.call(I,J.value));J.onChange=K;J.originalValue=A(I)}function A(I){return F.data(I,"numberbox").field.val()}function E(I,J){var K=F.data(I,"numberbox");var L=K.options;var M=A(I);J=L.parser.call(I,J);L.value=J;K.field.val(J);F(I).val(L.formatter.call(I,J));if(M!=J){L.onChange.call(I,J,M)}}function D(J){var I=F.data(J,"numberbox").options;F(J).unbind(".numberbox").bind("keypress.numberbox",function(K){return I.filter.call(J,K)}).bind("blur.numberbox",function(){E(J,F(this).val());F(this).val(I.formatter.call(J,A(J)))}).bind("focus.numberbox",function(){var K=A(J);if(K!=I.parser.call(J,F(this).val())){F(this).val(I.formatter.call(J,K))}})}function H(I){if(F.fn.validatebox){var J=F.data(I,"numberbox").options;F(I).validatebox(J)}}function C(I,K){var J=F.data(I,"numberbox").options;if(K){J.disabled=true;F(I).attr("disabled",true)}else{J.disabled=false;F(I).removeAttr("disabled")}}F.fn.numberbox=function(K,J){if(typeof K=="string"){var I=F.fn.numberbox.methods[K];if(I){return I(this,J)}else{return this.validatebox(K,J)}}K=K||{};return this.each(function(){var L=F.data(this,"numberbox");if(L){F.extend(L.options,K)}else{L=F.data(this,"numberbox",{options:F.extend({},F.fn.numberbox.defaults,F.fn.numberbox.parseOptions(this),K),field:B(this)});F(this).removeAttr("disabled");F(this).css({imeMode:"disabled"})}C(this,L.options.disabled);D(this);H(this);G(this)})};F.fn.numberbox.methods={options:function(I){return F.data(I[0],"numberbox").options},destroy:function(I){return I.each(function(){F.data(this,"numberbox").field.remove();F(this).validatebox("destroy");F(this).remove()})},disable:function(I){return I.each(function(){C(this,true)})},enable:function(I){return I.each(function(){C(this,false)})},fix:function(I){return I.each(function(){E(this,F(this).val())})},setValue:function(I,J){return I.each(function(){E(this,J)})},getValue:function(I){return A(I[0])},clear:function(I){return I.each(function(){var J=F.data(this,"numberbox");J.field.val("");F(this).val("")})},reset:function(I){return I.each(function(){var J=F(this).numberbox("options");F(this).numberbox("setValue",J.originalValue)})}};F.fn.numberbox.parseOptions=function(I){var J=F(I);return F.extend({},F.fn.validatebox.parseOptions(I),F.parser.parseOptions(I,["decimalSeparator","groupSeparator","suffix",{min:"number",max:"number",precision:"number"}]),{prefix:(J.attr("prefix")?J.attr("prefix"):undefined),disabled:(J.attr("disabled")?true:undefined),value:(J.val()||undefined)})};F.fn.numberbox.defaults=F.extend({},F.fn.validatebox.defaults,{disabled:false,value:"",min:null,max:null,precision:0,decimalSeparator:".",groupSeparator:"",prefix:"",suffix:"",filter:function(I){var J=F(this).numberbox("options");if(I.which==45){return(F(this).val().indexOf("-")==-1?true:false)}var K=String.fromCharCode(I.which);if(K==J.decimalSeparator){return(F(this).val().indexOf(K)==-1?true:false)}else{if(K==J.groupSeparator){return true}else{if((I.which>=48&&I.which<=57&&I.ctrlKey==false&&I.shiftKey==false)||I.which==0||I.which==8){return true}else{if(I.ctrlKey==true&&(I.which==99||I.which==118)){return true}else{return false}}}}},formatter:function(N){if(!N){return N}N=N+"";var M=F(this).numberbox("options");var L=N,J="";var I=N.indexOf(".");if(I>=0){L=N.substring(0,I);J=N.substring(I+1,N.length)}if(M.groupSeparator){var K=/(\d+)(\d{3})/;while(K.test(L)){L=L.replace(K,"$1"+M.groupSeparator+"$2")}}if(J){return M.prefix+L+M.decimalSeparator+J+M.suffix}else{return M.prefix+L+M.suffix}},parser:function(J){J=J+"";var I=F(this).numberbox("options");if(parseFloat(J)!=J){if(I.prefix){J=F.trim(J.replace(new RegExp("\\"+F.trim(I.prefix),"g"),""))}if(I.suffix){J=F.trim(J.replace(new RegExp("\\"+F.trim(I.suffix),"g"),""))}if(I.groupSeparator){J=F.trim(J.replace(new RegExp("\\"+I.groupSeparator,"g"),""))}if(I.decimalSeparator){J=F.trim(J.replace(new RegExp("\\"+I.decimalSeparator,"g"),"."))}J=J.replace(/\s/g,"")}var K=parseFloat(J).toFixed(I.precision);if(isNaN(K)){K=""}else{if(typeof(I.min)=="number"&&K<I.min){K=I.min.toFixed(I.precision)}else{if(typeof(I.max)=="number"&&K>I.max){K=I.max.toFixed(I.precision)}}}return K},onChange:function(J,I){}})})(jQuery);