(function(F){function G(I,J){var K=F.data(I,"window").options;if(J){F.extend(K,J)}F(I).panel("resize",K)}function D(I,J){var K=F.data(I,"window");if(J){if(J.left!=null){K.options.left=J.left}if(J.top!=null){K.options.top=J.top}}F(I).panel("move",K.options);if(K.shadow){K.shadow.css({left:K.options.left,top:K.options.top})}}function B(I,K){var L=F.data(I,"window");var M=L.options;var N=M.width;if(isNaN(N)){N=L.window._outerWidth()}if(M.inline){var J=L.window.parent();M.left=(J.width()-N)/2+J.scrollLeft()}else{M.left=(F(window)._outerWidth()-N)/2+F(document).scrollLeft()}if(K){D(I)}}function E(J,L){var K=F.data(J,"window");var N=K.options;var M=N.height;if(isNaN(M)){M=K.window._outerHeight()}if(N.inline){var I=K.window.parent();N.top=(I.height()-M)/2+I.scrollTop()}else{N.top=(F(window)._outerHeight()-M)/2+F(document).scrollTop()}if(L){D(J)}}function C(K){var J=F.data(K,"window");var I=F(K).panel(F.extend({},J.options,{border:false,doSize:true,closed:true,cls:"window",headerCls:"window-header",bodyCls:"window-body "+(J.options.noheader?"window-body-noheader":""),onBeforeDestroy:function(){if(J.options.onBeforeDestroy.call(K)==false){return false}if(J.shadow){J.shadow.remove()}if(J.mask){J.mask.remove()}},onClose:function(){if(J.shadow){J.shadow.hide()}if(J.mask){J.mask.hide()}J.options.onClose.call(K)},onOpen:function(){if(J.mask){J.mask.css({display:"block",zIndex:F.fn.window.defaults.zIndex++})}if(J.shadow){J.shadow.css({display:"block",zIndex:F.fn.window.defaults.zIndex++,left:J.options.left,top:J.options.top,width:J.window._outerWidth(),height:J.window._outerHeight()})}J.window.css("z-index",F.fn.window.defaults.zIndex++);J.options.onOpen.call(K)},onResize:function(N,M){var L=F(this).panel("options");F.extend(J.options,{width:L.width,height:L.height,left:L.left,top:L.top});if(J.shadow){J.shadow.css({left:J.options.left,top:J.options.top,width:J.window._outerWidth(),height:J.window._outerHeight()})}J.options.onResize.call(K,N,M)},onMinimize:function(){if(J.shadow){J.shadow.hide()}if(J.mask){J.mask.hide()}J.options.onMinimize.call(K)},onBeforeCollapse:function(){if(J.options.onBeforeCollapse.call(K)==false){return false}if(J.shadow){J.shadow.hide()}},onExpand:function(){if(J.shadow){J.shadow.show()}J.options.onExpand.call(K)}}));J.window=I.panel("panel");if(J.mask){J.mask.remove()}if(J.options.modal==true){J.mask=F('<div class="window-mask"></div>').insertAfter(J.window);J.mask.css({width:(J.options.inline?J.mask.parent().width():A().width),height:(J.options.inline?J.mask.parent().height():A().height),display:"none"})}if(J.shadow){J.shadow.remove()}if(J.options.shadow==true){J.shadow=F('<div class="window-shadow"></div>').insertAfter(J.window);J.shadow.css({display:"none"})}if(J.options.left==null){B(K)}if(J.options.top==null){E(K)}D(K);if(J.options.closed==false){I.window("open")}}function H(J){var I=F.data(J,"window");I.window.draggable({handle:">div.panel-header>div.panel-title",disabled:I.options.draggable==false,onStartDrag:function(K){if(I.mask){I.mask.css("z-index",F.fn.window.defaults.zIndex++)}if(I.shadow){I.shadow.css("z-index",F.fn.window.defaults.zIndex++)}I.window.css("z-index",F.fn.window.defaults.zIndex++);if(!I.proxy){I.proxy=F('<div class="window-proxy"></div>').insertAfter(I.window)}I.proxy.css({display:"none",zIndex:F.fn.window.defaults.zIndex++,left:K.data.left,top:K.data.top});I.proxy._outerWidth(I.window._outerWidth());I.proxy._outerHeight(I.window._outerHeight());setTimeout(function(){if(I.proxy){I.proxy.show()}},500)},onDrag:function(K){I.proxy.css({display:"block",left:K.data.left,top:K.data.top});return false},onStopDrag:function(K){I.options.left=K.data.left;I.options.top=K.data.top;F(J).window("move");I.proxy.remove();I.proxy=null}});I.window.resizable({disabled:I.options.resizable==false,onStartResize:function(K){I.pmask=F('<div class="window-proxy-mask"></div>').insertAfter(I.window);I.pmask.css({zIndex:F.fn.window.defaults.zIndex++,left:K.data.left,top:K.data.top,width:I.window._outerWidth(),height:I.window._outerHeight()});if(!I.proxy){I.proxy=F('<div class="window-proxy"></div>').insertAfter(I.window)}I.proxy.css({zIndex:F.fn.window.defaults.zIndex++,left:K.data.left,top:K.data.top});I.proxy._outerWidth(K.data.width);I.proxy._outerHeight(K.data.height)},onResize:function(K){I.proxy.css({left:K.data.left,top:K.data.top});I.proxy._outerWidth(K.data.width);I.proxy._outerHeight(K.data.height);return false},onStopResize:function(K){F.extend(I.options,{left:K.data.left,top:K.data.top,width:K.data.width,height:K.data.height});G(J);I.pmask.remove();I.pmask=null;I.proxy.remove();I.proxy=null}})}function A(){if(document.compatMode=="BackCompat"){return{width:Math.max(document.body.scrollWidth,document.body.clientWidth),height:Math.max(document.body.scrollHeight,document.body.clientHeight)}}else{return{width:Math.max(document.documentElement.scrollWidth,document.documentElement.clientWidth),height:Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight)}}}F(window).resize(function(){F("body>div.window-mask").css({width:F(window)._outerWidth(),height:F(window)._outerHeight()});setTimeout(function(){F("body>div.window-mask").css({width:A().width,height:A().height})},50)});F.fn.window=function(I,K){if(typeof I=="string"){var J=F.fn.window.methods[I];if(J){return J(this,K)}else{return this.panel(I,K)}}I=I||{};return this.each(function(){var L=F.data(this,"window");if(L){F.extend(L.options,I)}else{L=F.data(this,"window",{options:F.extend({},F.fn.window.defaults,F.fn.window.parseOptions(this),I)});if(!L.options.inline){document.body.appendChild(this)}}C(this);H(this)})};F.fn.window.methods={options:function(J){var I=J.panel("options");var K=F.data(J[0],"window").options;return F.extend(K,{closed:I.closed,collapsed:I.collapsed,minimized:I.minimized,maximized:I.maximized})},window:function(I){return F.data(I[0],"window").window},resize:function(I,J){return I.each(function(){G(this,J)})},move:function(I,J){return I.each(function(){D(this,J)})},hcenter:function(I){return I.each(function(){B(this,true)})},vcenter:function(I){return I.each(function(){E(this,true)})},center:function(I){return I.each(function(){B(this);E(this);D(this)})}};F.fn.window.parseOptions=function(I){return F.extend({},F.fn.panel.parseOptions(I),F.parser.parseOptions(I,[{draggable:"boolean",resizable:"boolean",shadow:"boolean",modal:"boolean",inline:"boolean"}]))};F.fn.window.defaults=F.extend({},F.fn.panel.defaults,{zIndex:9000,draggable:true,resizable:true,shadow:true,modal:false,inline:false,title:"New Window",collapsible:true,minimizable:true,maximizable:true,closable:true,closed:false})})(jQuery);